---
- name: "Core Base config"
  hosts: core
  connection: network_cli

  tasks:
    - name: "Configuring core routers base config"
      cli_config:
        config: "{{lookup('template','core_base_template.j2')}}"

- name: "Switch Base Config"
  hosts: switch
  connection: network_cli

  tasks:
    - name: "Configuring switch base config"
      cli_config:
        config: "{{lookup('template','switch_base_template.j2')}}"

- name: "Customer router config"
  hosts: customer
  connection: network_cli

  tasks:
    - name: "Building directory space"
      include_tasks: deploy/tasks/build_config_directory.yml

    - name: "Building customer config"
      include_tasks: deploy/tasks/prep_cust_config.yml

- name: "Configuring Switch for customer"
  hosts: switch
  connection: network_cli

  tasks:
    - name: "Preparing switch config"
      include_tasks: deploy/tasks/prep_switch_cust_config.yml


- name: "Configuring Core  for customer"
  hosts: core
  connection: network_cli

  tasks:
    - name: "Preparing core config"
      include_tasks: deploy/tasks/prep_core_rtr_cust_config.yml